<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML to Bee Editor Converter - POC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white border-b border-gray-200 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-6">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-gray-900">HTML ‚Üí Bee Editor Converter</h1>
                    <span class="ml-3 px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full">POC</span>
                </div>
                <div class="text-sm text-gray-500">Blueshift Labs</div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Introduction -->
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8">
            <h2 class="text-lg font-semibold text-blue-900 mb-2">üöÄ Proof of Concept</h2>
            <p class="text-blue-800">This demonstrates converting existing HTML email templates into Bee Editor compatible JSON format using Beefree's HTML Importer API.</p>
            <div class="mt-4 text-sm text-blue-700">
                <strong>Use Cases:</strong> Migrate from other ESPs, convert legacy templates, bulk import existing designs
            </div>
        </div>

        <!-- Main Interface -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Input Panel -->
            <div class="space-y-6">
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">üìÑ HTML Input</h3>
                    
                    <!-- Sample Templates -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Sample Templates:</label>
                        <div class="flex flex-wrap gap-2">
                            <button onclick="loadSample('newsletter')" class="px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded-md">Newsletter</button>
                            <button onclick="loadSample('ecommerce')" class="px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded-md">E-commerce</button>
                            <button onclick="loadSample('transactional')" class="px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded-md">Transactional</button>
                        </div>
                    </div>

                    <textarea 
                        id="htmlInput" 
                        class="w-full h-64 p-3 border border-gray-300 rounded-md font-mono text-sm"
                        placeholder="Paste your HTML email template here..."><!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Sample Email</title>
</head>
<body>
    <div style="max-width: 600px; margin: 0 auto; font-family: Arial, sans-serif;">
        <h1 style="color: #333; text-align: center;">Welcome to Blueshift!</h1>
        <p>Hello {{user.first_name}},</p>
        <p>Thank you for joining our community. We're excited to help you create amazing email experiences.</p>
        <div style="text-align: center; margin: 20px 0;">
            <a href="https://getblueshift.com" style="background: #007cba; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px;">Get Started</a>
        </div>
        <p style="font-size: 12px; color: #666;">
            You can <a href="{{unsubscribe_link}}">unsubscribe</a> at any time.
        </p>
    </div>
</body>
</html></textarea>

                    <div class="mt-4 flex gap-3">
                        <button 
                            onclick="convertHTML()" 
                            class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400"
                            id="convertBtn">
                            üîÑ Convert to Bee JSON
                        </button>
                        <button 
                            onclick="clearInput()" 
                            class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300">
                            Clear
                        </button>
                    </div>
                </div>

                <!-- Conversion Status -->
                <div id="statusPanel" class="hidden bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">üìä Conversion Status</h3>
                    <div id="statusContent"></div>
                </div>
            </div>

            <!-- Output Panel -->
            <div class="space-y-6">
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">üé® Bee Editor JSON Output</h3>
                    
                    <div class="mb-4 text-sm text-gray-600">
                        This JSON can be loaded directly into Blueshift's Visual Editor (Bee Editor)
                    </div>

                    <div id="outputContainer" class="min-h-64 border border-gray-300 rounded-md">
                        <div class="flex items-center justify-center h-64 text-gray-500">
                            Convert HTML to see Bee JSON output
                        </div>
                    </div>

                    <div class="mt-4 flex gap-3">
                        <button 
                            onclick="copyJSON()" 
                            class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400"
                            id="copyBtn" disabled>
                            üìã Copy JSON
                        </button>
                        <button 
                            onclick="downloadJSON()" 
                            class="px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-gray-400"
                            id="downloadBtn" disabled>
                            üíæ Download
                        </button>
                    </div>
                </div>

                <!-- API Integration Guide -->
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">‚ö° API Integration</h3>
                    <div class="text-sm text-gray-600 space-y-2">
                        <p><strong>Endpoint:</strong> <code class="bg-gray-100 px-2 py-1 rounded">POST /api/v1/email_templates/import_html</code></p>
                        <p><strong>Usage:</strong> Send HTML content, receive Bee JSON + create EmailTemplate</p>
                        <p><strong>Response Time:</strong> <span id="responseTime">-</span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Technical Details -->
        <div class="mt-12 bg-white rounded-lg shadow-sm border border-gray-200 p-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">üîß Technical Implementation</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-sm">
                <div>
                    <h4 class="font-semibold text-gray-900 mb-2">HTML Processing</h4>
                    <ul class="text-gray-600 space-y-1">
                        <li>‚Ä¢ Validates HTML structure</li>
                        <li>‚Ä¢ Converts merge tags to Bee format</li>
                        <li>‚Ä¢ Handles inline styles</li>
                        <li>‚Ä¢ Processes images and assets</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-900 mb-2">Bee JSON Generation</h4>
                    <ul class="text-gray-600 space-y-1">
                        <li>‚Ä¢ Uses Beefree HTML Importer API</li>
                        <li>‚Ä¢ Maintains responsive design</li>
                        <li>‚Ä¢ Preserves content structure</li>
                        <li>‚Ä¢ Adds Blueshift-specific config</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-900 mb-2">Blueshift Integration</h4>
                    <ul class="text-gray-600 space-y-1">
                        <li>‚Ä¢ Creates EmailTemplate record</li>
                        <li>‚Ä¢ Sets editor_type to 'visual'</li>
                        <li>‚Ä¢ Stores bee_editor_json</li>
                        <li>‚Ä¢ Maintains HTML backup</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        let convertedJSON = null;
        let startTime = null;

        // Sample templates
        const samples = {
            newsletter: `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Weekly Newsletter</title>
</head>
<body>
    <div style="max-width: 600px; margin: 0 auto; font-family: Arial, sans-serif; background-color: #f8f9fa;">
        <div style="background: #007cba; color: white; text-align: center; padding: 20px;">
            <h1 style="margin: 0;">Weekly Newsletter</h1>
            <p style="margin: 5px 0 0 0;">Stay updated with our latest news</p>
        </div>
        <div style="padding: 20px; background: white;">
            <p>Hi {{user.first_name}},</p>
            <h2 style="color: #333;">This Week's Highlights</h2>
            <div style="border-left: 3px solid #007cba; padding-left: 15px; margin: 20px 0;">
                <h3 style="color: #007cba; margin: 0;">Feature Update</h3>
                <p>We've improved our email editor with better performance and new templates.</p>
            </div>
            <div style="text-align: center; margin: 30px 0;">
                <a href="https://getblueshift.com/updates" style="background: #28a745; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px;">Read More</a>
            </div>
        </div>
        <div style="text-align: center; padding: 20px; color: #666; font-size: 12px;">
            <p>¬© 2024 Blueshift. <a href="{{unsubscribe_link}}">Unsubscribe</a></p>
        </div>
    </div>
</body>
</html>`,
            ecommerce: `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Special Offer</title>
</head>
<body>
    <div style="max-width: 600px; margin: 0 auto; font-family: Arial, sans-serif;">
        <div style="text-align: center; padding: 20px; background: #ff6b6b; color: white;">
            <h1 style="margin: 0;">üéâ Special Offer</h1>
            <p style="margin: 5px 0 0 0;">Limited time only!</p>
        </div>
        <div style="padding: 20px; background: white;">
            <p>Hello {{user.first_name}},</p>
            <p>Don't miss out on our exclusive 25% off sale!</p>
            
            <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 20px 0; text-align: center;">
                <img src="https://via.placeholder.com/200x150" alt="Product" style="max-width: 100%; height: auto;">
                <h3 style="color: #333; margin: 10px 0;">Premium Product</h3>
                <p style="color: #666; margin: 5px 0;">Was: <strike>$100</strike> Now: <strong style="color: #ff6b6b;">$75</strong></p>
            </div>
            
            <div style="text-align: center; margin: 30px 0;">
                <a href="https://shop.example.com" style="background: #ff6b6b; color: white; padding: 15px 30px; text-decoration: none; border-radius: 4px; font-weight: bold;">Shop Now</a>
            </div>
            
            <p style="color: #666; font-size: 14px;">Offer expires in 48 hours. Use code: SAVE25</p>
        </div>
        <div style="text-align: center; padding: 15px; color: #999; font-size: 12px;">
            <a href="{{unsubscribe_link}}">Unsubscribe</a> | <a href="{{email_preview_link}}">View Online</a>
        </div>
    </div>
</body>
</html>`,
            transactional: `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Order Confirmation</title>
</head>
<body>
    <div style="max-width: 600px; margin: 0 auto; font-family: Arial, sans-serif;">
        <div style="background: #28a745; color: white; text-align: center; padding: 20px;">
            <h1 style="margin: 0;">‚úÖ Order Confirmed</h1>
            <p style="margin: 5px 0 0 0;">Thank you for your purchase</p>
        </div>
        <div style="padding: 20px; background: white;">
            <p>Hi {{user.first_name}},</p>
            <p>Your order has been confirmed and will be shipped soon.</p>
            
            <div style="background: #f8f9fa; padding: 15px; border-radius: 4px; margin: 20px 0;">
                <h3 style="margin: 0 0 10px 0; color: #333;">Order Details</h3>
                <table style="width: 100%; border-collapse: collapse;">
                    <tr>
                        <td style="padding: 5px 0; border-bottom: 1px solid #ddd;"><strong>Order #:</strong></td>
                        <td style="padding: 5px 0; border-bottom: 1px solid #ddd;">{{order.id}}</td>
                    </tr>
                    <tr>
                        <td style="padding: 5px 0; border-bottom: 1px solid #ddd;"><strong>Date:</strong></td>
                        <td style="padding: 5px 0; border-bottom: 1px solid #ddd;">{{order.date}}</td>
                    </tr>
                    <tr>
                        <td style="padding: 5px 0;"><strong>Total:</strong></td>
                        <td style="padding: 5px 0; font-weight: bold;">{{order.total}}</td>
                    </tr>
                </table>
            </div>
            
            <div style="text-align: center; margin: 30px 0;">
                <a href="{{order.tracking_link}}" style="background: #007cba; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px;">Track Your Order</a>
            </div>
            
            <p style="color: #666; font-size: 14px;">Questions? Reply to this email or contact support.</p>
        </div>
        <div style="text-align: center; padding: 15px; color: #999; font-size: 12px;">
            <p>This is a transactional email. You cannot unsubscribe from order confirmations.</p>
        </div>
    </div>
</body>
</html>`
        };

        function loadSample(type) {
            document.getElementById('htmlInput').value = samples[type];
            showStatus('info', `Loaded ${type} sample template`);
        }

        function clearInput() {
            document.getElementById('htmlInput').value = '';
            document.getElementById('outputContainer').innerHTML = '<div class="flex items-center justify-center h-64 text-gray-500">Convert HTML to see Bee JSON output</div>';
            document.getElementById('copyBtn').disabled = true;
            document.getElementById('downloadBtn').disabled = true;
            convertedJSON = null;
            hideStatus();
        }

        async function convertHTML() {
            const htmlContent = document.getElementById('htmlInput').value.trim();
            
            if (!htmlContent) {
                showStatus('error', 'Please enter HTML content to convert');
                return;
            }

            const convertBtn = document.getElementById('convertBtn');
            convertBtn.disabled = true;
            convertBtn.textContent = 'üîÑ Converting...';
            
            startTime = Date.now();
            showStatus('info', 'Converting HTML to Bee Editor JSON...');

            try {
                const result = await simulateAPICall(htmlContent);
                
                const responseTime = Date.now() - startTime;
                document.getElementById('responseTime').textContent = `${responseTime}ms`;
                
                displayResult(result);
                showStatus('success', `Successfully converted HTML to Bee JSON (${responseTime}ms)`);
                
                document.getElementById('copyBtn').disabled = false;
                document.getElementById('downloadBtn').disabled = false;
                
            } catch (error) {
                showStatus('error', `Conversion failed: ${error.message}`);
            } finally {
                convertBtn.disabled = false;
                convertBtn.textContent = 'üîÑ Convert to Bee JSON';
            }
        }

        async function simulateAPICall(htmlContent) {
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            const mockBeeJSON = {
                "page": {
                    "body": {
                        "container": {
                            "style": {
                                "background-color": "#FFFFFF"
                            }
                        },
                        "content": {
                            "style": {
                                "font-family": "Arial, Helvetica, sans-serif",
                                "color": "#000000"
                            },
                            "computedStyle": {
                                "linkColor": "#007cba",
                                "messageBackgroundColor": "transparent",
                                "messageWidth": "600px"
                            }
                        }
                    },
                    "rows": [
                        {
                            "type": "one-column-empty",
                            "columns": [
                                {
                                    "grid-columns": 12,
                                    "modules": [
                                        {
                                            "type": "mailup-bee-newsletter-modules-text",
                                            "descriptor": {
                                                "text": {
                                                    "html": analyzeHTMLContent(htmlContent),
                                                    "style": {
                                                        "color": "#333333",
                                                        "font-family": "Arial, Helvetica, sans-serif"
                                                    }
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                "blueshift": {
                    "conversion_meta": {
                        "source": "html_import",
                        "timestamp": new Date().toISOString(),
                        "merge_tags_converted": extractMergeTags(htmlContent).length,
                        "original_html_length": htmlContent.length
                    }
                }
            };

            return mockBeeJSON;
        }

        function analyzeHTMLContent(html) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = html;
            
            const scripts = tempDiv.querySelectorAll('script, style');
            scripts.forEach(el => el.remove());
            
            const body = tempDiv.querySelector('body');
            return body ? body.innerHTML : tempDiv.innerHTML;
        }

        function extractMergeTags(html) {
            const mergeTagPattern = /\{\{([^}]+)\}\}/g;
            const matches = [];
            let match;
            while ((match = mergeTagPattern.exec(html)) !== null) {
                matches.push(match[1]);
            }
            return matches;
        }

        function displayResult(result) {
            convertedJSON = result;
            
            const outputContainer = document.getElementById('outputContainer');
            outputContainer.innerHTML = `
                <pre class="text-xs overflow-auto h-64 p-3"><code class="language-json">${JSON.stringify(result, null, 2)}</code></pre>
            `;
            
            if (window.Prism) {
                Prism.highlightAll();
            }
        }

        function copyJSON() {
            if (!convertedJSON) return;
            
            navigator.clipboard.writeText(JSON.stringify(convertedJSON, null, 2)).then(() => {
                showStatus('success', 'JSON copied to clipboard!');
            });
        }

        function downloadJSON() {
            if (!convertedJSON) return;
            
            const blob = new Blob([JSON.stringify(convertedJSON, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `bee-template-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showStatus('success', 'JSON template downloaded!');
        }

        function showStatus(type, message) {
            const statusPanel = document.getElementById('statusPanel');
            const statusContent = document.getElementById('statusContent');
            
            const colors = {
                info: 'bg-blue-50 text-blue-800 border-blue-200',
                success: 'bg-green-50 text-green-800 border-green-200',
                error: 'bg-red-50 text-red-800 border-red-200'
            };
            
            const icons = {
                info: 'üí°',
                success: '‚úÖ',
                error: '‚ùå'
            };
            
            statusContent.innerHTML = `
                <div class="p-3 rounded-md border ${colors[type]}">
                    ${icons[type]} ${message}
                </div>
            `;
            
            statusPanel.classList.remove('hidden');
        }

        function hideStatus() {
            document.getElementById('statusPanel').classList.add('hidden');
        }
    </script>
</body>
</html>